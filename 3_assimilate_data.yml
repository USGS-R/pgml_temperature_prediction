packages:
  - scipiper
  - dplyr
  - yaml
  - dataRetrieval
  - assertthat
  - glmtools

file_extensions:
  - ind

sources:
  - 3_assimilate_data/src/assimilate.R 

target_default: 3_assimilate_data/out/data_summary_plots.pdf

include:
  - 1_data_s3_cleaned.yml
  - 1_data_wqp.yml

targets:
  3_assimilate_data/out/nhd_120052238.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_120052238"), state_src = I("DOW"), 
             state_id = I(c('69084500')), wqp_file = '1_data_wqp/out/nhd_120052238.rds.ind',
             '1_data_s3_cleaned/out/MN_fisheries_all_temp_data_Jan2018.rds.ind','1_data_s3_cleaned/out/MPCA_temp_data_all.rds.ind','1_data_s3_cleaned/out/URL_Temp_Logger_2006_to_2017.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_120052238.rds:
    command: s3_get('3_assimilate_data/out/nhd_120052238.rds.ind')
      
  3_assimilate_data/out/nhd_4817675.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_4817675"), state_src = I("DOW"), 
             state_id = I(c('11020300','11020301')), wqp_file = '1_data_wqp/out/nhd_4817675.rds.ind',
             '1_data_s3_cleaned/out/MN_fisheries_all_temp_data_Jan2018.rds.ind','1_data_s3_cleaned/out/MPCA_temp_data_all.rds.ind','1_data_s3_cleaned/out/URL_Temp_Logger_2006_to_2017.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_4817675.rds:
    command: s3_get('3_assimilate_data/out/nhd_4817675.rds.ind')
      
  3_assimilate_data/out/nhd_120052195.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_120052195"), state_src = I("DOW"), 
             state_id = I(c('39000200')), wqp_file = '1_data_wqp/out/nhd_120052195.rds.ind',
             '1_data_s3_cleaned/out/MN_fisheries_all_temp_data_Jan2018.rds.ind','1_data_s3_cleaned/out/MPCA_temp_data_all.rds.ind','1_data_s3_cleaned/out/URL_Temp_Logger_2006_to_2017.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_120052195.rds:
    command: s3_get('3_assimilate_data/out/nhd_120052195.rds.ind')
      
  3_assimilate_data/out/nhd_2360642.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_2360642"), state_src = I("DOW"), 
             state_id = I(c('48000200')), wqp_file = '1_data_wqp/out/nhd_2360642.rds.ind',
             '1_data_s3_cleaned/out/MN_fisheries_all_temp_data_Jan2018.rds.ind','1_data_s3_cleaned/out/MPCA_temp_data_all.rds.ind','1_data_s3_cleaned/out/URL_Temp_Logger_2006_to_2017.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_2360642.rds:
    command: s3_get('3_assimilate_data/out/nhd_2360642.rds.ind')
      
  3_assimilate_data/out/nhd_120052233.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_120052233"), state_src = I("DOW"), 
             state_id = I(c('69069400')), wqp_file = '1_data_wqp/out/nhd_120052233.rds.ind',
             '1_data_s3_cleaned/out/MN_fisheries_all_temp_data_Jan2018.rds.ind','1_data_s3_cleaned/out/MPCA_temp_data_all.rds.ind','1_data_s3_cleaned/out/URL_Temp_Logger_2006_to_2017.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_120052233.rds:
    command: s3_get('3_assimilate_data/out/nhd_120052233.rds.ind')
      
  3_assimilate_data/out/nhd_120052889.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_120052889"), state_src = I("DOW"), 
             state_id = I(c('04003501')), wqp_file = '1_data_wqp/out/nhd_120052889.rds.ind',
             '1_data_s3_cleaned/out/MN_fisheries_all_temp_data_Jan2018.rds.ind','1_data_s3_cleaned/out/MPCA_temp_data_all.rds.ind','1_data_s3_cleaned/out/URL_Temp_Logger_2006_to_2017.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_120052889.rds:
    command: s3_get('3_assimilate_data/out/nhd_120052889.rds.ind')
      
  3_assimilate_data/out/nhd_7142570.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_7142570"), state_src = I("DOW"), 
             state_id = I(c('69037800','69037801','69037802')), wqp_file = '1_data_wqp/out/nhd_7142570.rds.ind',
             '1_data_s3_cleaned/out/MN_fisheries_all_temp_data_Jan2018.rds.ind','1_data_s3_cleaned/out/MPCA_temp_data_all.rds.ind','1_data_s3_cleaned/out/URL_Temp_Logger_2006_to_2017.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_7142570.rds:
    command: s3_get('3_assimilate_data/out/nhd_7142570.rds.ind')
      
  3_assimilate_data/out/nhd_120052896.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_120052896"), state_src = I("DOW"), 
             state_id = I(c('11014700')), wqp_file = '1_data_wqp/out/nhd_120052896.rds.ind',
             '1_data_s3_cleaned/out/MN_fisheries_all_temp_data_Jan2018.rds.ind','1_data_s3_cleaned/out/MPCA_temp_data_all.rds.ind','1_data_s3_cleaned/out/URL_Temp_Logger_2006_to_2017.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_120052896.rds:
    command: s3_get('3_assimilate_data/out/nhd_120052896.rds.ind')
      
  3_assimilate_data/out/nhd_13293262.rds.ind:
    command: assimilate_data(nhd_id = I("nhd_13293262"), state_src = I("UWID"), 
             state_id = I(c('ME')), wqp_file = '1_data_wqp/out/nhd_13293262.rds.ind',
             '1_data_s3_cleaned/out/long_term_ntl.rds.ind','1_data_s3_cleaned/out/mendota_daily_buoy.rds.ind','1_data_s3_cleaned/out/mendota_temps_long.rds.ind')
    depends: 
      - lib/crosswalks/rawfile_to_id_crosswalk.csv
      - lib/cfg/base_model_config.yml
  3_assimilate_data/out/nhd_13293262.rds:
    command: s3_get('3_assimilate_data/out/nhd_13293262.rds.ind')
      
  3_assimilate_data/out/data_summary_plots.pdf:
    command: summarize_assimilated('3_assimilate_data/out/nhd_120052238.rds.ind','3_assimilate_data/out/nhd_4817675.rds.ind','3_assimilate_data/out/nhd_120052195.rds.ind','3_assimilate_data/out/nhd_2360642.rds.ind','3_assimilate_data/out/nhd_120052233.rds.ind','3_assimilate_data/out/nhd_120052889.rds.ind','3_assimilate_data/out/nhd_7142570.rds.ind','3_assimilate_data/out/nhd_120052896.rds.ind','3_assimilate_data/out/nhd_13293262.rds.ind')
